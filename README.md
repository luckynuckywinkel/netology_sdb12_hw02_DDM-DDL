# Домашнее задание к занятию «Работа с данными (DDL/DML)», Лебедев А. И., FOPS-10


---

Задание можно выполнить как в любом IDE, так и в командной строке.

### Задание 1
1.1. Поднимите чистый инстанс MySQL версии 8.0+. Можно использовать локальный сервер или контейнер Docker.

1.2. Создайте учётную запись sys_temp. 

1.3. Выполните запрос на получение списка пользователей в базе данных. (скриншот)

1.4. Дайте все права для пользователя sys_temp. 

1.5. Выполните запрос на получение списка прав для пользователя sys_temp. (скриншот)

1.6. Переподключитесь к базе данных от имени sys_temp.

Для смены типа аутентификации с sha2 используйте запрос: 
```sql
ALTER USER 'sys_test'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';
```
1.6. По ссылке https://downloads.mysql.com/docs/sakila-db.zip скачайте дамп базы данных.

1.7. Восстановите дамп в базу данных.

1.8. При работе в IDE сформируйте ER-диаграмму получившейся базы данных. При работе в командной строке используйте команду для получения всех таблиц базы данных. (скриншот)

*Результатом работы должны быть скриншоты обозначенных заданий, а также простыня со всеми запросами.*  


### Решение:    

- Так как я начал этот модуль с выполнения задания 12-03 (то есть, следующего за этим), у меня уже есть контейнер с MySQL и туда добавлены пользователи root и admin.

- Давайте выведем список всех пользователей моей БД:

![users](img/1.JPG)   

- Поиграемся с пользователем admin (у него, а я уже это знаю, прав на работу с БД не достаточно), посмотрим его права, посмотрим права пользователя root, раздадим полные права пользователю admin:

![grants](img/2.JPG)  

- Т.к. по условию задания нам нужно создать нового пользователя - создадим его и дадим, также, все права:

![new_user](img/3.JPG)   

- Дамп базы данных уже был скачан и скопирован в MySQL при помощи команд:

```
bash-4.4# mysql -u root -p sakila < sakila-schema.sql
Enter password:
bash-4.4# mysql -u root -p sakila < sakila-data.sql
Enter password:
```

- Зайдем в базу под вновь созданным пользователем и посмотрим, видим ли мы ее:

![new_user](img/4.JPG)  

Все супер!

---

### Задание 2
Составьте таблицу, используя любой текстовый редактор или Excel, в которой должно быть два столбца: в первом должны быть названия таблиц восстановленной базы, во втором названия первичных ключей этих таблиц. Пример: (скриншот/текст)
```
Название таблицы | Название первичного ключа
customer         | customer_id
```

### Решение:    

- Вероятно, вскоре мне понадобится, все-таки, поставить какую-то графику...и excel. Выглядеть это все будет, примерно, вот так:

```
+----------------------------+--------------------------+
| Таблица                    | Первичный ключ           |
+----------------------------+--------------------------+
| actor                      | actor_id                 |
| actor_info                 | actor_id                 |
| address                    | address_id               |
| category                   | category_id              |
| city                       | city_id                  |
| country                    | country_id               |
| customer                   | customer_id              |
| customer_list              | ID                       |
| film                       | film_id, actor_id, category_id, language_id, inventory_id, country_id|                  
| film_actor                 | actor_id, film_id        |
| film_category              | film_id, category_id, language_id|
| film_list                  | film_list_id             |
| film_text                  | film_text_id, language_id, category_id|                  
| inventory                  | inventory_id             |
| language                   | language_id              |
| nicer_but_slower_film_list | nicer_but_slower_film_list_id|                      
| payment                    | payment_id, customer_id, staff_id|
| rental                     | rental_id                |
| sales_by_film_category     | sales_by_film_category_id|
| sales_by_store             | sales_by_store_id, film_id, sales_by_film_category_id|                    
| staff                      | staff_id                 |
| staff_list                 | staff_list_id. staff_id  |                     
| store                      | store_id                 |
+----------------------------+--------------------------+
```

---


## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

### Задание 3*
3.1. Уберите у пользователя sys_temp права на внесение, изменение и удаление данных из базы sakila.

3.2. Выполните запрос на получение списка прав для пользователя sys_temp. (скриншот)

*Результатом работы должны быть скриншоты обозначенных заданий, а также простыня со всеми запросами.*  

### Решение:  

- Дадим и отнимем права на все таблицы из sakila для пользователя sys_temp:


![new_user](img/5.JPG)  

---  

### Доработка:   

Да, действительно, в базе представлены таблицы представлений. Я упустил этот момент. И да, я сразу же добавил не только первичные ключи для связи таблиц. Полагаю, в идеальном виде, все будет выглядеть вот так:  

```
+----------------------------+------------------+
| Таблица                    | Первичный ключ   |
+----------------------------+------------------+
| actor                      | actor_id         |
| actor_info                 | actor_id         |
| address                    | address_id       |
| category                   | category_id      |
| city                       | city_id          |
| country                    | country_id       |
| customer                   | customer_id      |
| film                       | film_id          |
| film_actor                 | actor_id         |
|                            | film_id          |
| film_category              | film_id          |
|                            | category_id      |
| film_text                  | film_id          |
| inventory                  | inventory_id     |
| language                   | language_id      |
| payment                    | payment_id       |
| rental                     | rental_id        |
| staff                      | staff_id         |
| store                      | store_id         |
| customer_list              |                  |
| film_list                  |                  |
| nicer_but_slower_film_list |                  |
| sales_by_film_category     |                  |
| sales_by_store             |                  |
| staff_list                 |                  |
+----------------------------+------------------+
```

Здесь мы используем составные первичные ключи для некоторых таблиц. Я выписал их в столбик для понимания. Таблицы представлений без ключей внизу.
